一些linux系统的默认DNS服务器是本地服务器，另一些可能会使用google的DNS服务器，地址8.8.8.8，然而近年来管控越发严格，google的DNS服务在国内很容易被污染以至于无法正常工作（这里在虚拟机内容易出现网络问题，因为linux系统可能默认DNS服务只有本地，需要手动加入，这个小问题时常导致系统联网困难而又很难排查清楚）
如下图所示：DNS污染导致不能获取到baidu.com的正确ip地址(但是一些国外网址的DNS未被污染)
![[Pasted image 20240814212131.png]]
切换为国内DNS服务后
正确的ip地址如下：
![[Pasted image 20240814212344.png]]


https://www.itdojo.com/resolver-cache-linux-vs-windows/
Linux 默认情况下并没有系统层级的 DNS 缓存（可以添加模块实现这一功能）
因此对于终端访问时，若进行了DNS服务器的添加，只要将终端刷新，即可使用新的DNS服务，并没有清理系统级缓存的操作（windows是有DNS缓存的）



为了更稳定的网络访问，现代的浏览器/包管理器等应用基本都会内置独立于系统的DNS解析
也就是说，linux系统DNS服务失效对不同模块的影响是有限的
但是在windows上，由于存在DNS缓存，一旦发生DNS污染，很容易导致大量应用无法得到正确的DNS服务
不过目前大概问题也不大了


### 神奇的代理服务与fake ip
观察到一个现象，clash开启tun后终端的ping无法正常得到dns解析
解析的ip地址全部指向了内部的198.18.0.xxx这一网段，
后来才发现，这就是clash的服务提供机制
clash在tun模式下“截获”了系统发出的dns请求，然后返回一个地址198.18.0.xxx(这个地址用于后续的真实ip相关操作，但是ping无法处理这种“怪异的”ip地址)，然后clash将dns请求转发给代理服务提供方，让代理服务方提供正确的dns解析再返回这个解析ip地址，然后再通过一些更高层次的奇妙网络操作，实现本机与目标ip的通信